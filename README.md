| Таблица         | Смысл                                                     | Ключевые связи                                  |
| --------------- | --------------------------------------------------------- | ----------------------------------------------- |
| `calls`         | История всех звонков из ВАТС                              | → `orders.main_call_id`, → `call_order.call_id` |
| `orders`        | Основная сущность CRM, связанная со звонками и контактами | ↔ `call_order`, ↔ `contact_order`               |
| `call_order`    | Связь M:N между звонками и заказами                       | `order_id`, `call_id`                           |
| `contacts`      | Все контакты (телефоны, мессенджеры и др.)                | ↔ `contact_order.contact_id`                    |
| `contact_order` | Связь M:N между заказами и контактами                     | `order_id`, `contact_id`                        |



| Связь                                     | Тип                 | Описание                                            |
| ----------------------------------------- | ------------------- | --------------------------------------------------- |
| `orders.main_call_id → calls.id`          | 1 : 1               | У заказа может быть один главный звонок             |
| `orders ↔ calls (через call_order)`       | M : N               | Один заказ может иметь несколько звонков (история)  |
| `orders ↔ contacts (через contact_order)` | M : N               | Один заказ может иметь несколько контактов          |
| `contact_order.is_primary`                | bool                | Указывает, какой контакт основной в этом заказе     |
| `contacts`                                | 1 : N (через pivot) | Один контакт может участвовать в нескольких заказах |
